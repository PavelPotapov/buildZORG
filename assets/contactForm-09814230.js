import{L as r}from"./loader-896b65bd.js";import{c,a as d,b as h,d as a,e as m,g as o,f as u,h as n}from"./colorTheme-68c1091f.js";async function f(l,t){try{return(await fetch(l,{method:"POST",body:t})).ok}catch{return!1}}class i{constructor(){return i.instance||(i.instance=this),this.state={open:!1,deleteBtnShown:!1,filesUpload:!1},this.selectors={deleteBtn:"[data-js='delete-file']",modalCrossBtn:"[data-js='contact-modal-cross']",contactFormModal:"[data-js='contact-modal']",overlay:"[data-js='contact-form-overlay']",inputFile:"#input-file",getFileBtn:"[data-js='get-file-btn']",form:"[data-js='contact-form']",items:"[data-js='vacancy-item']",title:"[data-js='contact-modal-title']",date:"[data-js='contact-modal-date']",workType:"[data-js='contact-modal-work-type']",message:"[data-js='contact-modal-message']",requirementsItem:"[data-js='contact-modal-req-item']",requirementsList:"[data-js='contact-modal-req-list']",requirementsTitle:"[data-js='contact-modal-req-title']",clearFormBtn:"[data-js='contact-modal-reset']"},this.classes={openContactForm:"contact-modal--open",overlayActive:"active",deleteBtnActive:"contact-modal__delete-file--shown"},this.dataAttributes={form:"data-js-details",item:"data-js-contact-form-info"},this.loader=new r,this.findElements(),this.acceptEvents(),i.instance}findElements(){this.deleteBtn=document.querySelector(this.selectors.deleteBtn),this.modalCrossBtn=document.querySelector(this.selectors.modalCrossBtn),this.contactFormModal=document.querySelector(this.selectors.contactFormModal),this.overlay=document.querySelector(this.selectors.overlay),this.inputFile=document.querySelector(this.selectors.inputFile),this.getFileBtn=document.querySelector(this.selectors.getFileBtn),this.form=document.querySelector(this.selectors.form),this.items=document.querySelectorAll(this.selectors.items),this.date=document.querySelector(this.selectors.date),this.title=document.querySelector(this.selectors.title),this.workType=document.querySelector(this.selectors.workType),this.message=document.querySelector(this.selectors.message),this.requirementsItems=document.querySelectorAll(this.selectors.requirementsItem),this.requirementsList=document.querySelector(this.selectors.requirementsList),this.requirementsTitle=document.querySelector(this.selectors.requirementsTitle),this.clearFormBtn=document.querySelector(this.selectors.clearFormBtn)}clearContents(){this.title.innerHTML="",this.date.innerHTML="",this.workType.innerHTML="",this.message.innerHTML="",c(this.requirementsList),this.deleteBtn.click()}putInfoInside(t){t?(this.requirementsTitle.innerHTML="Основные требования:",this.title.innerHTML=t.title,this.date.innerHTML=t.date,this.workType.innerHTML=t.typeWork,this.message.innerHTML=t.message,t.requirements.forEach(e=>{d("li",{"data-js":"contact-modal-req-item",class:"contact-modal__requirements-item"},this.requirementsList).innerHTML=e}),this.requirementsItems.forEach((e,s,F)=>{e.innerHTML=t.requirements[s]})):this.requirementsTitle.innerHTML=""}toggleModalContact(t){this.contactFormModal&&this.overlay&&(this.state.open=!this.state.open,this.state.open?(h(),this.clearContents(),this.putInfoInside(t),this.overlay.classList.add(this.classes.overlayActive),this.contactFormModal.classList.add(this.classes.openContactForm),a(600).then(()=>this.contactFormModal.style.overflowY="auto")):(this.contactFormModal.classList.remove(this.classes.openContactForm),this.overlay.classList.remove(this.classes.overlayActive),m()))}showFileName(){this.inputFile.files&&this.inputFile.files.length>0?this.getFileBtn.textContent=this.inputFile.files[0].name:this.getFileBtn.textContent="Прикрепить резюме"}bindSubmitForm(){this.form.addEventListener("submit",t=>{t.preventDefault(),this.sendFormData(),this.clearFormBtn.click()})}async sendFormData(){try{const t=new FormData(this.form),e=o(this.form,this.dataAttributes.form).url;this.loader.showLoader(),await f(e,t)?u():n()}catch{n()}finally{this.loader.hideLoader(),this.toggleModalContact(),await a(500),this.clearContents(),this.clearFormBtn.click()}}bindClearFormBtn(){this.clearFormBtn.addEventListener("click",t=>{t.target.click()})}bindClickItems(){this.items.forEach(t=>t.addEventListener("click",e=>{const s=o(e.currentTarget,this.dataAttributes.item);s?this.toggleModalContact(s):this.toggleModalContact()}))}bindClickGetFileBtn(){this.getFileBtn&&this.getFileBtn.addEventListener("click",t=>{t.preventDefault(),this.inputFile.click()})}bindClickOverlay(){this.overlay&&this.overlay.addEventListener("click",t=>{this.modalCrossBtn.click()})}bindClickModalCrossBtn(){this.modalCrossBtn&&this.contactFormModal&&this.modalCrossBtn.addEventListener("click",()=>{this.toggleModalContact()})}bindChangeInputFile(){this.inputFile&&this.inputFile.addEventListener("change",t=>{this.state.filesUpload=!0,this.state.deleteBtnShown=!0,this.deleteBtn.classList.add(this.classes.deleteBtnActive),this.showFileName()})}bindDeleteBtnClick(){this.deleteBtn&&this.deleteBtn.addEventListener("click",()=>{this.inputFile.value=null,this.state.filesUpload=!1,this.state.deleteBtnShown=!1,this.deleteBtn.classList.remove(this.classes.deleteBtnActive),this.showFileName()})}acceptEvents(){this.bindClickModalCrossBtn(),this.bindChangeInputFile(),this.bindDeleteBtnClick(),this.bindClickGetFileBtn(),this.bindClickItems(),this.bindClickOverlay(),this.bindClearFormBtn(),this.bindSubmitForm()}}new i;
